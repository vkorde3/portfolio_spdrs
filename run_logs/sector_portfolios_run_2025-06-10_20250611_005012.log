2025-06-11 00:50:12,172 - INFO - Starting sector portfolios generation for 2025-06-10
2025-06-11 00:50:29,254 - ERROR - Error during sector portfolios generation
Traceback (most recent call last):
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\datetimes.py", line 603, in get_loc
    parsed, reso = self._parse_with_reso(key)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\datetimes.py", line 559, in _parse_with_reso
    parsed, reso = super()._parse_with_reso(label)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\datetimelike.py", line 293, in _parse_with_reso
    parsed, reso_str = parsing.parse_datetime_string_with_reso(label, freqstr)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "parsing.pyx", line 442, in pandas._libs.tslibs.parsing.parse_datetime_string_with_reso
  File "parsing.pyx", line 666, in pandas._libs.tslibs.parsing.dateutil_parse
pandas._libs.tslibs.parsing.DateParseError: Unknown datetime string format, unable to parse: ret

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\portfolio_spdrs\dagster_pipelines\assets\portfolio_asset.py", line 58, in sector_portfolios
    df_portfolios: pd.DataFrame = produce_sector_portfolios(partition_date, logger=file_logger, half_life=30)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\portfolio_spdrs\dagster_pipelines\assets\portfolio_producer.py", line 138, in produce_sector_portfolios
    pt_results = calc_betas(
                 ^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\vbase_utils\stats\pit_robust_betas.py", line 157, in pit_robust_betas
    df_fact_rets_stacked["ret"], axis=0
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\multi.py", line 3040, in get_loc
    loc = self._get_level_indexer(key, level=0)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\multi.py", line 3391, in _get_level_indexer
    idx = self._get_loc_single_level_index(level_index, key)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\multi.py", line 2980, in _get_loc_single_level_index
    return level_index.get_loc(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\kvs39\Desktop\validityBase\Dagster\dagster_env\Lib\site-packages\pandas\core\indexes\datetimes.py", line 605, in get_loc
    raise KeyError(key) from err
KeyError: 'ret'
